# 🌱 **坎昆（Cancun）升级是什么？**

- **Cancun** 是以太坊的一个 **硬分叉升级（Hard Fork）**，在以太坊的历史中属于“网络协议升级”。
    
- 它的主要目标是 **优化 EVM 执行效率、降低 gas 成本、改进合约存储等**。
    
- 每次升级都会对 EVM 的某些操作码或协议规则进行修改。
    

> 类似于操作系统更新，新版本的以太坊可能会改变一些底层规则。

---

# 🔹 **和 selfdestruct 相关的变化**

你贴的合约里有：

`selfdestruct(payable(msg.sender));`

- **坎昆升级前**：
    
    - `selfdestruct` 会销毁合约，把剩余 ETH 转给指定地址，并从链上移除合约的存储和代码。
        
- **坎昆升级后**：
    
    - 以太坊决定 **不再允许通过 `selfdestruct` 删除合约**，
        
    - 只能实现 **内部 ETH 转移**，合约本身仍然存在于链上（代码和存储不会被删除）。
        

---

# 🔹 **为什么会这样？**

以太坊官方的考虑：

1. `selfdestruct` 会引起 **状态回收复杂化**，影响 EVM 存储管理。
    
2. 在某些攻击场景下，滥用 `selfdestruct` 可能破坏合约逻辑或引发安全问题。
    
3. 因此，从 Cancun 升级开始，`selfdestruct` 仅能做 **余额转移**，不会删除合约本身。
    

---

# 🔹 **总结**

- **坎昆（Cancun）**：以太坊的一次重大升级/硬分叉
    
- **对 selfdestruct 的影响**：
    
    - 升级前：销毁合约 + 转 ETH
        
    - 升级后：只转 ETH，合约仍然存在