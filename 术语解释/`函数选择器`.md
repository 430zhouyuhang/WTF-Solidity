# 🌱 **1️⃣ 函数选择器（function selector）**

### **定义**

- 在以太坊中，每个函数都有一个 **4 字节的唯一标识**，叫 **函数选择器**（function selector）。
    
- 它是用 **函数签名（function signature）** 通过 Keccak-256 哈希得到的前 4 个字节。
    

### **函数签名**

- 函数签名 = `"函数名(参数类型列表)"`
    
- 例如：
    

`function foo(uint256 x, address addr) external {}`

- 函数签名就是：
    

`"foo(uint256,address)"`

### **生成函数选择器**

1. 对函数签名进行 Keccak-256 哈希
    
2. 取前 4 个字节 → 就是函数选择器
    

**示例：**

`bytes4 selector = bytes4(keccak256("foo(uint256,address)"));`

- 这个 `selector` 就是 EVM 用来 **识别调用哪个函数** 的标识。
    
- 在跨合约调用时（低级 `call`），EVM 会读取调用数据的前 4 个字节，找到对应函数执行。
    

---

### **作用**

- 当你用：
    

`abi.encodeWithSignature("foo(uint256,address)", x, addr);`

- 编码结果前面自动加上了 **函数选择器**
    
- 调用其他合约时，EVM 会根据这 4 个字节找到对应函数，然后把剩余的数据当作参数传入。
    

> 🔑 4 字节选择器就是函数的“门牌号”，EVM 根据它来判断应该调用哪个函数。